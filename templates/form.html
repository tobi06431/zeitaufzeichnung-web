<!DOCTYPE html><html lang="de"><head>  <meta charset="UTF-8">  <title>Zeitaufzeichnung</title>  <meta name="viewport" content="width=device-width, initial-scale=1">  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}"></head><body><h2>Zeitaufzeichnung</h2><form method="post">  <label>Kath. Kirchengemeinde    <input name="Kath. Kirchengemeinde">  </label>  <label>Einsatzort    <input name="Einsatzort">  </label>  <label>GKZ    <input name="GKZ">  </label>  <label>Monat/Jahr    <input name="Monat/Jahr">  </label>  <label>Nachname    <input name="Nachname">  </label>  <label>Vorname    <input name="Vorname">  </label>  <label>Geburtsdatum    <input name="Geburtsdatum">  </label>  <label>Pers.-Nr.    <input name="Pers.-Nr.">  </label>  <label>Tätigkeit    <input name="Tätigkeit">  </label>  <label>Beschäftigungsumfang    <input name="Beschäftigungsumfang">  </label>  <label>Mehrarbeit (Textfeld)    <input name="Mehrarbeit (Textfeld)">  </label>  <label>Mehrarbeit Stunden    <input name="Mehrarbeit Stunden">  </label>  <label>Datum</label>  <div class="row">    <input id="datum" name="Datum">    <button type="button"      onclick="document.getElementById('datum').value='{{ today }}'">      Heute    </button>  </div>  <label>Mehrarbeitsstunden auszahlen</label>  <select name="Mehrarbeit_auszahlen">    <option value="Nein" selected>Nein</option>    <option value="Ja">Ja</option>  </select>  <!-- ================= GOTTESDIENSTE ================= -->  <h3>Gottesdienste</h3>  <div class="gd-box">    <label>Kirchort      <input type="text" id="gd_kirchort">    </label>    <label>Datum      <input type="date" id="gd_datum">    </label>    <label>Besoldungssatz (€)      <input type="number" id="gd_satz" step="0.01">    </label>    <label>Dienstbeginn      <input type="time" id="gd_beginn">    </label>    <label>Dienstende      <input type="time" id="gd_ende">    </label>    <button type="button" onclick="addGottesdienst()">      Gottesdienst hinzufügen    </button>  </div>  <table>    <thead>      <tr>        <th>Kirchort</th>        <th>Datum</th>        <th>Satz (€)</th>        <th>Beginn</th>        <th>Ende</th>        <th>Aktion</th>      </tr>    </thead>    <tbody id="gd_liste"></tbody>  </table>  <input type="hidden" name="Gottesdienste" id="gottesdienste_json">  <div class="actions">    <!-- formnovalidate = PDF immer erzeugbar -->    <button type="submit" formnovalidate>PDF erzeugen</button>  </div></form><script>let gottesdienste = [];function addGottesdienst() {  const kirchort = document.getElementById("gd_kirchort").value.trim();  const datum = document.getElementById("gd_datum").value;  const satz = document.getElementById("gd_satz").value;  const beginn = document.getElementById("gd_beginn").value;  const ende = document.getElementById("gd_ende").value;  if (!kirchort || !datum || !satz || !beginn || !ende) {    alert("Bitte alle Felder ausfüllen.");    return;  }  gottesdienste.push({ kirchort, datum, satz, beginn, ende });  document.getElementById("gd_kirchort").value = "";  document.getElementById("gd_datum").value = "";  document.getElementById("gd_satz").value = "";  document.getElementById("gd_beginn").value = "";  document.getElementById("gd_ende").value = "";  updateListe();}function removeGottesdienst(index) {  gottesdienste.splice(index, 1);  updateListe();}function updateListe() {  const tbody = document.getElementById("gd_liste");  tbody.innerHTML = "";  gottesdienste.forEach((gd, index) => {    const row = document.createElement("tr");    row.innerHTML = `      <td>${gd.kirchort}</td>      <td>${gd.datum}</td>      <td>${gd.satz}</td>      <td>${gd.beginn}</td>      <td>${gd.ende}</td>      <td>        <button type="button" onclick="removeGottesdienst(${index})">X</button>      </td>    `;    tbody.appendChild(row);  });  document.getElementById("gottesdienste_json").value =    JSON.stringify(gottesdienste);}/* ===== WICHTIG: Submit-Absicherung ===== */document.querySelector("form").addEventListener("submit", function () {  const kirchort = document.getElementById("gd_kirchort").value.trim();  const datum = document.getElementById("gd_datum").value;  const satz = document.getElementById("gd_satz").value;  const beginn = document.getElementById("gd_beginn").value;  const ende = document.getElementById("gd_ende").value;  const irgendwas = kirchort || datum || satz || beginn || ende;  const allesVoll = kirchort && datum && satz && beginn && ende;  // Halb ausgefüllte Gottesdienst-Eingaben verwerfen  if (irgendwas && !allesVoll) {    document.getElementById("gd_kirchort").value = "";    document.getElementById("gd_datum").value = "";    document.getElementById("gd_satz").value = "";    document.getElementById("gd_beginn").value = "";    document.getElementById("gd_ende").value = "";  }  // JSON vor dem Absenden immer sauber setzen  document.getElementById("gottesdienste_json").value =    JSON.stringify(gottesdienste);});</script></body></html>